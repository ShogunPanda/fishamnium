#!/usr/bin/env fish
#
# This file is part of fishamnium. Copyright (C) 2013 and above Shogun <shogun@cowtech.it>.
# Licensed under the MIT license, which can be found at http://www.opensource.org/licenses/mit-license.php.
#

set required_fish_version 2
set current_fish_version (fish --version ^| cut -d ' ' -f 3 | cut -d . -f 1)
set command $1
set destdir /tmp/fishamnium-(date +%Y%m%d%H%M%S)
set rootdir ~/.fishamnium

if [ $required_fish_version -gt $current_fish_version ];
  echo "fishamnium requires at least Fish $required_fish_version.0 (you have $current_fish_version). You can obtain the latest version at http://fishshell.com/"
  exit 1
end

[ "$FISHAMNIUM_OPERATION" != "uninstall" ]; and set FISHAMNIUM_OPERATION "install"
echo "Running: git clone https://github.com/ShogunPanda/fishamnium -q -- \"$destdir\""; and git clone https://github.com/ShogunPanda/fishamnium -q -- "$destdir"
and echo "Running: cd \"$destdir\""; and cd "$destdir"
and echo "Running: mkdir -p \"$rootdir\""; and mkdir -p "$rootdir"
and echo "Running: /bin/cp -a -f loader.fish completions helpers plugins themes \"$rootdir\""; and /bin/cp -a -f loader.fish completions helpers plugins themes "$rootdir"
and echo "Running: /bin/ln -s -f \"$rootdir/helpers/fishamnium_git\" \"$rootdir/helpers/g\""; and /bin/ln -s -f "$rootdir/helpers/fishamnium_git" "$rootdir/helpers/g"
and echo "Running: /bin/ln -s -f \"$rootdir/helpers/fishamnium_bookmarks\" \"$rootdir/helpers/d\""; and /bin/ln -s -f "$rootdir/helpers/fishamnium_bookmarks" "$rootdir/helpers/d"
and echo "Running: chmod -R 755 \"$rootdir\""; and chmod -R 755 "$rootdir"
and echo "Running: /bin/rm -rf \"$destdir\""; and /bin/rm -rf "$destdir"
