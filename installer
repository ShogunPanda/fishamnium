#!/usr/bin/env fish
#
# This file is part of fishamnium. Copyright (C) 2013 and above Shogun <shogun@cowtech.it>.
# Licensed under the MIT license, which can be found at http://www.opensource.org/licenses/mit-license.php.
#

set required_fish_version 2
set current_fish_version (fish --version ^| cut -d ' ' -f 3 | cut -d . -f 1)
set command $1
set destdir /tmp/fishamnium-(date +%Y%m%d%H%M%S)

if [ $required_fish_version -gt $current_fish_version ];
  echo "fishamnium requires at least Fish $required_fish_version.0 (you have $current_fish_version). You can obtain the latest version at http://fishshell.com/"
  exit 1
end

[ "$FISHAMNIUM_OPERATION" != "uninstall" ]; and set FISHAMNIUM_OPERATION "install"
git clone https://github.com/ShogunPanda/fishamnium -q -- "$destdir"; and cd "$destdir"; and sudo rake $FISHAMNIUM_OPERATION\[true\]; and /bin/rm -rf "$destdir";